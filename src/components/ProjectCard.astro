---
import type { CollectionEntry } from "astro:content";

type ProjectEntry = CollectionEntry<"projects">;

const { project } = Astro.props as { project: ProjectEntry };

const publishDate = new Date(project.data.publishDate).toLocaleDateString(
  "en-US",
  {
    year: "numeric",
    month: "short",
  },
);

const link = project.data.externalUrl ?? `/projects/${project.slug}`;
const linkLabel = project.data.externalUrl
  ? "Visit project"
  : "Read case study";
---

<a
  class="group relative flex flex-col gap-4 p-8 rounded-3xl bg-surface/50 border border-white/5 hover:border-accent-cyan/30 hover:bg-white/5 transition-all duration-300 hover:-translate-y-1 hover:shadow-lg"
  href={link}
>
  <div
    class="flex items-center justify-between gap-4 text-sm text-secondary/80"
  >
    <span
      class={`px-3 py-1 rounded-full text-xs font-medium border ${
        project.data.status === "launched"
          ? "bg-green-500/10 border-green-500/20 text-green-400"
          : project.data.status === "in-progress"
            ? "bg-yellow-500/10 border-yellow-500/20 text-yellow-400"
            : "bg-slate-500/10 border-slate-500/20 text-slate-400"
      } capitalize`}
    >
      {project.data.status}
    </span>
    <span class="font-mono text-xs">{publishDate}</span>
  </div>

  <div>
    <h3
      class="text-2xl font-bold mb-2 group-hover:text-accent-cyan transition-colors"
    >
      {project.data.title}
    </h3>
    <p class="text-secondary leading-relaxed group-hover:text-secondary/90">
      {project.data.summary}
    </p>
  </div>

  {
    project.data.roles.length > 0 && (
      <p class="text-sm text-secondary/70">
        Roles: {project.data.roles.join(", ")}
      </p>
    )
  }

  {
    project.data.stack.length > 0 && (
      <ul class="flex flex-wrap gap-2 mt-auto pt-4">
        {project.data.stack.map((item) => (
          <li class="px-3 py-1 rounded-full bg-white/5 text-xs text-secondary group-hover:text-white transition-colors">
            {item}
          </li>
        ))}
      </ul>
    )
  }

  <div
    class="pt-4 mt-2 border-t border-white/5 flex items-center text-accent-cyan font-medium text-sm group-hover:text-accent-violet transition-colors"
  >
    {linkLabel}
    <span class="ml-2 transition-transform group-hover:translate-x-1">â†’</span>
  </div>
</a>
